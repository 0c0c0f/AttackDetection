alert tcp any any -> $HOME_NET any (msg: "[PT OPEN] SVN/Git Remote Code Execution through malicious svn+ssh:// URL (Multiple CVEs)"; flow: established; content: "ssh://-"; nocase; reference: cve, 2017-9800; reference: cve, 2017-12426; reference: cve, 2017-1000116; reference: cve, 2017-1000117; reference: url, subversion.apache.org/security/CVE-2017-9800-advisory.txt; classtype: attempted-admin; sid: 10001756; rev: 2; )

alert tcp any !$HTTP_PORTS -> $HOME_NET any (msg: "[PT OPEN] SVN/Git Remote Code Execution through malicious svn+ssh:// URL (Multiple CVEs)"; flow: established; content: "ssh://"; nocase; pcre: "/ssh\:\/\/(?:[^@\s]+@)?[a-zA-Z0-9\:\.\-\_\[\]\@]*[^a-zA-Z0-9\:\.\-\_\[\]\@\/\ ]/i"; reference: cve, 2017-9800; reference: cve, 2017-12426; reference: cve, 2017-1000116; reference: cve, 2017-1000117; reference: url, subversion.apache.org/security/CVE-2017-9800-advisory.txt; classtype: attempted-admin; sid: 10001757; rev: 2; )

alert http any any -> $HOME_NET any (msg: "[PT OPEN] SVN/Git Remote Code Execution through malicious svn+ssh:// URL (Multiple CVEs)"; flow: established, from_server; content: "30"; http_stat_code; depth: 2; content: "Location:"; http_header; nocase; content: "ssh://"; nocase; http_header; distance: 0; pcre: "/ssh\:\/\/(?:[^@\s]+@)?[a-zA-Z0-9\:\.\-\_\[\]\@]*[^a-zA-Z0-9\:\.\-\_\[\]\@\/\ ]/Hi"; reference: cve, 2017-9800; reference: cve, 2017-12426; reference: cve, 2017-1000116; reference: cve, 2017-1000117; reference: url, subversion.apache.org/security/CVE-2017-9800-advisory.txt; classtype: attempted-admin; sid: 10001763; rev: 1; )
